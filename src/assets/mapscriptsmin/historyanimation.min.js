var path,route,geoMarker,animating,vectorLayer,startMarker,endMarker,speedInput,startButton,f,anim,animationPoints=[],historycoords=[],historydetails="";function AddHistoryPoints(e,t){var r=new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform(t,"EPSG:4326","EPSG:3857"))}),o=new ol.style.Style({image:new ol.style.Icon({scale:.2,anchor:[.8,1],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"assets/mapimages/markers/bluedot.png"})});r.setStyle(o),r.setProperties(e);var a=new ol.source.Vector({features:[r]}),n=new ol.layer.Vector({source:a});map.addLayer(n),animationPoints.push(n)}function InitiateSlider(){speedInput=document.getElementById("speed"),sliderspeed=Number(speedInput.value)/10,(startButton=document.getElementById("start-animation")).addEventListener("click",startAnimation,!1)}function AnimationHistory(e,t){try{for(var r=0;r<historyAnimationLayer.length;r++)map.removeLayer(historyAnimationLayer[r]);historyAnimationLayer=[]}catch(e){}historycoords=e,historydetails=t;var o=[],a=[72.8777,19.076];o.push(a),a=[82.9739,25.3176],o.push(a);var n=new ol.geom.LineString(e);n.transform("EPSG:4326","EPSG:3857");var i=(route=n).getCoordinates(),s=i.length;routeFeature=new ol.Feature({type:"route",geometry:route}),geoMarker=new ol.Feature({type:"geoMarker",geometry:new ol.geom.Point(i[0])}),startMarker=new ol.Feature({geometry:new ol.geom.Point(i[0])}),endMarker=new ol.Feature({geometry:new ol.geom.Point(i[s-1])});var l={route:new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:[204,199,68,0]})}),icon:new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],src:"assets/mapimages/mapstyleicon/directionarrow1.png"})})};startMarker.setStyle(function(e,t){return new ol.style.Style({image:new ol.style.Icon({anchor:[.5,30],scale:1/Math.pow(t,1/3)<.8727382060717654?.5167961026557844:.8727382060717654,anchorXUnits:"fraction",anchorYUnits:"pixels",src:"assets/mapimages/markers/startpoint2.png"})})}),startMarker.setProperties(t);var y=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],src:"assets/mapimages/mapstyleicon/directionarrow1.png"})});endMarker.setStyle(y),geoMarker=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:2,src:"assets/mapimages/mapstyleicon/directionarrow1.png"})}),animating=!1;var c=new ol.source.Vector({features:[routeFeature,startMarker,endMarker]});vectorLayer=new ol.layer.Vector({source:c,style:function(e){return l[e.get("type")]}}),map.addLayer(vectorLayer),historyAnimationLayer.push(vectorLayer),path=c.getFeatures()[0],c.once("change",function(e){"ready"===c.getState()&&(path=c.getFeatures()[0])})}function startAnimation(){try{AnimationHistory(historycoords,historydetails)}catch(e){}path&&((f=new ol.Feature(new ol.geom.Point([0,0]))).setStyle(geoMarker),(anim=new ol.featureAnimation.Path({path:route,rotate:!0,easing:ol.easing.linear,speed:sliderspeed,revers:!1})).on("animating",e=>{console.log("eeee "+JSON.stringify(e.geom.values_)),map.getView().setCenter(e.geom.getCoordinates()),map.getView().setRotation(0)}),animating=vectorLayer.animateFeature(f,anim))}function PlotCoditionline(e,t){for(var r=[],o=0;o<e.length;o++){var a=ol.proj.fromLonLat(e[o]);r.push(a)}var n={LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:3})})},i={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[{type:"Feature",geometry:{type:"LineString",coordinates:r}}]},s=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(i)}),l=new ol.layer.Vector({source:s,style:function(e){return n[e.getGeometry().getType()]}});map.addLayer(l),historylayercontional.push(l)}function ClearHistoryAnimation(){historycoords=[],historydetails="";for(var e=0;e<historyAnimationLayer.length;e++)map.removeLayer(historyAnimationLayer[e]);historyAnimationLayer=[]}