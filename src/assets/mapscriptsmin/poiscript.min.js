var lat,lon,poiDetails={};function PoiCreate(){map.on("dblclick",function(t){if(1==poiFlag){console.info(t.pixel),console.info(map.getPixelFromCoordinate(t.coordinate)),console.info(ol.proj.toLonLat(t.coordinate));var e=ol.proj.toLonLat(t.coordinate);lat=e[1],lon=e[0];var a="Latitude: "+lat+" Longitude: "+lon;console.log("seprate Lat longs are   "+a);var o=ol.proj.fromLonLat(e);console.log("here open layer   "+o);var r="<div class='popupMainDiv'><table class='popCustomTable'><tr class='tableheader'><td colspan='2' style='text-align:center;'>Create POI</td></tr><tr><td class='leftTd'>Name</td><td class='rightTd'><input type='text' class='form-control ' placeholder='Enter Name' id='newpoiName' style=' background-color: white !important;  border: 1px solid blue !important; height: 25px !important; font-size: 11px; width: 165px !important; color:black;'></td></tr><tr><td class='leftTd'>Type</td><td class='rightTd'><input type='text' class='form-control '  placeholder='Enter Type' id='newpoiType'  style=' background-color: white !important;  border: 1px solid blue !important;  height: 25px !important; font-size: 11px; width: 165px !important; color:black;'></td></tr><tr><td class='leftTd'>Range</td><td class='rightTd'><input type='text' class='form-control '  placeholder='Enter Range' id='newpoiRange'  style=' background-color: white !important;  border: 1px solid blue !important; height: 25px !important; font-size: 11px; width: 165px !important; color:black;'></td></tr><tr><td colspan='2' >Latitude &nbsp; &nbsp;"+lat.toFixed(4)+"&nbsp; &nbsp; Longitude &nbsp; &nbsp;"+lon.toFixed(4)+"</td></tr><tr><td colspan='2'><button class='btn btn-primary' style='height:24px;float: right; margin-right: 41px;' onclick='SavePoi()'><h6 style='  font-size:12px;  margin-top: -3px;'>Save</h6></button></tr>";content.innerHTML=r,popup.setPosition(o)}})}function PoiData(t){for(var e=0;e<t.length;e++){var a=[];a.push(Number(t[e].param7)),a.push(Number(t[e].param6));var o={data:{type:"poi",title:"POI Details",Name:t[e].param2,Range:t[e].param8,Type:t[e].param3,Location:t[e].param5}};try{PoiplotFunction(a,o,"assets/mapimages/markers/poinewmarker.png")}catch(t){}}}function GetPoiDetails(){var t={pageNo:"",itemsPerPage:"",searchBy:"",searchType:"",totalRecords:"NA",pageID:pageId,pageName:pagename,pageURL:pageurl};$.ajax({url:apiurl+"poidetails",type:"post",data:JSON.stringify(t),headers:{Headerkey:headerkey,Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"https://track.indtrack.com/vtsindtrackapi/","Access-Control-Allow-Methods":"GET, POST, OPTIONS, PUT, PATCH, DELETE","Access-Control-Allow-Headers":"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers"},dataType:"json",success:function(t){var e=t.entity.list;try{ClearPoi()}catch(t){}try{PoiData(e)}catch(t){}}})}function SavePoi(){var t="";$.ajax({url:"https://nominatim.openstreetmap.org/reverse?format=json&lon="+lon+"&lat="+lat,type:"get",dataType:"json",success:function(e){t=e.display_name;var a={param1:"",param2:$("#newpoiName").val(),param3:$("#newpoiType").val(),param4:"",param5:t,param6:$("#newpoiRange").val(),param7:lat,param8:lon,pageID:pageId,pageName:pagename,pageURL:pageurl};$.ajax({url:apiurl+"insertpoi",type:"post",data:JSON.stringify(a),headers:{Headerkey:headerkey,Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"https://track.indtrack.com/vtsindtrackapi/","Access-Control-Allow-Methods":"GET, POST, OPTIONS, PUT, PATCH, DELETE","Access-Control-Allow-Headers":"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers"},dataType:"json",success:function(t){"Successfully saved."==t.entity?(alert(t.entity),GetPoiDetails()):alert(t.entity)}})}})}