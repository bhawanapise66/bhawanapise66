<div class="row">
  <div class="col-12 col-md-12 col-lg-12 col-xl-12 mx-auto align-self-center">
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header" style="padding-top: 0; padding-bottom: 0">
        <!-- <img src="../assets/img/logoicon.svg" alt="" class="w-50px mt-4"> -->
        <h6 class="text-left m-1"><i class="material-icons md-18">grid_on</i>&nbsp;Railway Device
          <span class="text-template-primary" style=" color: #00ed53;">Management</span>
        </h6>
      </div>
      <div class="card-body">
        <div class="row justify-content-center">
          <div class="col-md-12 mx-auto">


            <div class="container-fluid main-container" id="main-container">

              <div class="col-md-12" >
                <div class="row" style=" border: 3px ridge #040c4b" *ngIf="keybooleana">
                  <div class="col-md-12">

                    <div class="form-group row">
                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Section</label>
                        <span class="mandatory">*</span>
                        <ngx-select-dropdown tabindex="1" id="sectionentry" [multiple]="false"
                          [(ngModel)]="selectsectionentry" [config]="config" [options]="ListOfSection"
                          class="ngx-dropdown-container ngx-dropdown-button" (change)="selectsectiondummy()"
                          style="font-size:11px"></ngx-select-dropdown>
                      </div>
                      <div class="col-lg-4 col-md-4" style="display: none;">
                        <label class="indlabel">Dummy Section</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Enter Section" tabindex="2" required
                          minlength="3" maxlength="50" id="sectiondummyupdate" onpaste="return false;"
                          [(ngModel)]="selectsectionreturn" #vendornm="ngModel" ondrop="return false;"
                          style="font-size:11px">
                      </div>

                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Received Date</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control datepicker" tabindex="3" required id="receivedateidentry"
                         onkeypress="avoidSplChars(event)" style="font-size:11px">
                      </div>

                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Device No</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Device No" tabindex="4" required
                          id="devicenoidentry" [(ngModel)]="devicenoTextentry" #DeviceNo="ngModel"
                          minlength="8" maxlength="50" style="font-size:11px">
                      </div>  <!-- onkeypress="return isNumberKey(event)"  -->
                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">IMEI No</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="IMEI No" tabindex="5" required
                          onkeypress="return isNumberKey(event)" id="imeinoidentry" [(ngModel)]="imeinoTextentry"
                          #IMEINo="ngModel" minlength="8" maxlength="15" style="font-size:11px">
                      </div>

                      <div id="basmob1" class="col-lg-2 col-md-2">
                        <label class="indlabel">Mobile No</label>&nbsp;
                        <!-- <span class="indlabelstar">*</span> -->
                        <input type="text" class="form-control" style=" font-size:11px" placeholder="Mobile No."
                          tabindex="6" minlength="10" maxlength="13" [(ngModel)]="mobileTextentry" #mobile="ngModel"
                          onkeypress="return isNumberKey(event)" id="mobileidentry">
                      </div>
                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Assign To</label>
                        <span class="mandatory">*</span>
                        <ngx-select-dropdown tabindex="7" id="assigntoentry" [multiple]="false"
                          [(ngModel)]="selectassigntoentry" [config]="config" [options]="ListOfAssignTo"
                          (change)="selectassigntodummy()" style="font-size:11px"></ngx-select-dropdown>
                      </div>
                      <div class="col-lg-4 col-md-4" style="display: none;">
                        <label class="indlabel">Dummy AssignTo</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Enter AssignTo" required minlength="3"
                          maxlength="50" id="assigntodummyupdate" onpaste="return false;"
                          [(ngModel)]="selectassigntoreturn" #vendornm="ngModel" ondrop="return false;">
                      </div>

                    </div>

                    <div class="form-group row">
                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Device Status</label>
                        <span class="mandatory">*</span>
                        <ngx-select-dropdown tabindex="8" id="statusentry" [multiple]="false"
                          [(ngModel)]="selectstatusentry" [config]="config" [options]="ListOfDeviceStatus"
                          (change)="selectdevicestatusdummy()" style="font-size:11px"></ngx-select-dropdown>
                      </div>

                      <div class="col-lg-4 col-md-4" style="display: none;">
                        <label class="indlabel">Dummy Devicestatus</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Enter DeviceStatus" required minlength="3"
                          maxlength="50" id="devicestatusdummyupdate" onpaste="return false;"
                          [(ngModel)]="selectdevicestatusreturn" #vendornm="ngModel" ondrop="return false;">
                      </div>

                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">NETWORK</label>
                        <span class="mandatory">*</span>
                        <ngx-select-dropdown tabindex="9" id="networkentry" [multiple]="false"
                          [(ngModel)]="selectnetworkentrynew" [config]="config" [options]="ListOfNetwork"
                          (change)="selectnetworkdummy()" style="font-size:11px"></ngx-select-dropdown>
                      </div>
                      <div class="col-lg-4 col-md-4" style="display: none;">
                        <label class="indlabel">Dummy NETWORK</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Enter Network" required minlength="3"
                          maxlength="50" id="networkdummyupdate" onpaste="return false;"
                          [(ngModel)]="selectnetworkreturn" #vendornm="ngModel" ondrop="return false;">
                      </div>

                      <!--  <div class="col-lg-2 col-md-2">
                            <label class="indlabel">NETWORK</label>
                            <span class="mandatory">*</span>
                            <ngx-select-dropdown tabindex="9" id="networkentry" [multiple]="false" [(ngModel)]="selectnetworkentrynew"
                            [config]="config" [options]="ListOfNetwork" (change)="selectnetworkdummy()" style="font-size:11px" ></ngx-select-dropdown>
                          </div>
                          <div class="col-lg-4 col-md-4" style="display: none;">
                            <label class="indlabel">Dummy Network</label>
                            <span class="mandatory">*</span>
                            <input type="text" class="form-control" placeholder="Enter Network" id="networkdummyupdate" 
                            [(ngModel)]="selectnetworkreturn" >
                          </div> -->

                      <div class="col-lg-2 col-md-2">
                        <label class="indlabel">Remarks</label>
                        <span class="mandatory">*</span>
                        <input type="text" class="form-control" placeholder="Remarks" tabindex="10" required
                          id="remarksentry" [(ngModel)]="RemarksTextentry" #remarks="ngModel" minlength="5"
                          maxlength="30" style="font-size:11px">
                      </div>

                      <div id="saveentry" class="col-sm-1 col-md-1"
                        style=" float:right; padding-top: 2%; padding-left: 4%;">
                        <button tabindex="11" class="mb-2 btn btn-sm btn-success" (click)="ADDRecord()">
                          Submit
                        </button>
                      </div>

                      <div id="updateentry" class="col-sm-1 col-md-1"
                        style=" float:right; padding-top: 2%; padding-left: 4%;">
                        <button tabindex="12" class="mb-2 btn btn-sm btn-success" (click)="UpdateRecord()">
                          Update
                        </button>
                      </div>

                      <div class="col-sm-1 col-md-1" style=" float: left; padding-top: 2%;">

                        <button tabindex="13" id="clearentry" class="mb-2 btn btn-sm btn-danger"
                          (click)="clearfunction()">
                          Clear
                        </button>
                      </div>

                      <div class="col-lg-4 col-md-4">

                        <div class="maxminwarn" *ngIf="DeviceNo.errors?.minlength">
                          Device no. must be at least minimum 8 characters & maximum 50 characters long.
                        </div>

                        <div class="maxminwarn" *ngIf="IMEINo.errors?.minlength">
                          IMEI no. must be at least minimum 8 characters & maximum 15 characters long.
                        </div>

                        <div class="maxminwarn" *ngIf="mobile.errors?.minlength">
                          Mobile No. must be at least minimum 10 characters & maximum 13 characters long.
                        </div>

                        <div class="maxminwarn" *ngIf="remarks.errors?.minlength">
                          Remarks must be at least minimum 5 characters & maximum 30 characters long.
                        </div>
                        <div id="alertmsg" style=" color: rgb(236, 105, 105); padding-top: 6%;">
                          {{ successMessage }}
                        </div>

                      </div>
                    </div>
                  </div>
                </div>

                <div id="managementdiv">

                  <div class="row mt-3 mx-1">
                    <div class="col-12 col-sm-12 col-md text-md-left align-self-center pr-0">
                      <ul class="nav  justify-sm-content-center  justify-content-left">
                        <li class="nav-item ">

                          <div class="input-group">
                            <input type="text" placeholder="Search" class="form-control searchicon " id="searchData"
                              [(ngModel)]="filter" aria-label="Amount (to the nearest dollar)">
                            <div class="input-group-append">
                              <button class="btn  apendbtn" (click)="searchdata()"><i
                                  style="color: #00ed54; margin-top: -15px;" class="fa fa-search"></i> </button>
                            </div>
                          </div>

                        </li>
                        <li class="nav-item mx-3">
                          <i class="fa fa-refresh fa-2x fa-spin-hover" style="font-size: 17px;
                            padding-top: 4px;
                            color: #00fff3;" (click)="RefreshDeviceDetail()"></i>
                        </li>
                      </ul>
                    </div>

                    <div class="col-12 col-sm-12 col-md-auto text-right text-md-end pl-0">
                      <ul class="nav justify-content-center justify-lg-content-end  justify-sm-content-center">
                        <li class="nav-item mx-2">
                          <img style="float: right; cursor: pointer; height: 20px; margin-top: 3px;"
                            (click)="createPDF()" ngbTooltip="PDF" src="assets/images/PDFicon.png">
                        </li>
                        <li class="nav-item mx-3">
                          <img style="cursor: pointer;" (click)="dataexportexcel()" ngbTooltip="Excel"
                            src="assets/images/excellogo.png">
                        </li>
                        <li class="nav-item mx-3">
                          <span style="display: inline;font-size:12px;font-weight :bold;">Show Rows : </span> <select class="form-control p-1"
                          style="width: 44px;display: inline;" data-live-search="true" tabindex="1" id="selectronet" (change)="RowsBindChanged()" aria-hidden="true"
                           [(ngModel)]="selectRowsText">
                           <option value="10" >10</option>
                           <option value="15" selected>15</option>                           
                           <option value="20">20</option>
                           <option value="50">50</option>
                          </select>
                        </li>                       
                        <li class="nav-item ml-3">
                          <span> Total Records&nbsp;:&nbsp;{{outorec}}&nbsp;of&nbsp;{{totrec}} </span>
                        </li>
                      </ul>
                    </div>
                  </div>


                  <div class="card-body table-responsive">
                    <table class="table table-hover table-striped">
                      <thead>
                        <tr>
                          <th style=" display: none;">VehicleID</th>
                          <th style=" display: none;">Assign ToID</th>
                          <th style=" display: none;">Device StatusID</th>
                          <th style=" display: none;">Network ID</th>
                          <th style=" display: none;">Section ID</th>
                          <th (click)="sort('rowNumber')">#</th>
                          <th (click)="sort('param69')">Section / Department</th>
                          <th (click)="sort('param74')">Received Date</th>
                          <th (click)="sort('param12')">Device No</th>
                          <th (click)="sort('param4')">IMEI NO</th>
                          <th (click)="sort('param5')">Mobile No.</th>
                          <th (click)="sort('param7')">Network</th>
                          <th (click)="sort('param37')">Assign To</th>
                          <th (click)="sort('param61')">Device Status</th>
                          <th (click)="sort('param40')">Polling Time</th>
                          <th (click)="sort('param75')">Remark</th>
                          <th id="actionid">Action</th>
                        </tr>
                      </thead>
                      <tbody id="grid">
                        <tr      
                          *ngFor="let dev of devdetail$ | filter:filter | orderBy: key : reverse | paginate: { itemsPerPage: pagecount, currentPage: p, totalItems: totrec} ;"
                          style=" padding: 0.35rem 0.5rem;">
                          <td style=" padding: 0.35rem 0.5rem; display: none;">{{dev.param11}}</td>
                          <td style=" padding: 0.35rem 0.5rem; display: none;">{{dev.param37}}</td>
                          <td style=" padding: 0.35rem 0.5rem; display: none;">{{dev.param60}}</td>
                          <td style=" padding: 0.35rem 0.5rem; display: none;">{{dev.param6}}</td>
                          <td style=" padding: 0.35rem 0.5rem; display: none;">{{dev.param8}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.rowNumber}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param69}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param74 | date:'dd-MMM-yyyy'}}</td>
                          <!-- | date:'dd-MMM-yyyy HH:mm:ss a' -->
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param12}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param2}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param5}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param7}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param37}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param61}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param40 | date:'dd-MMM-yyyy hh:mm:ss aa'}}</td>
                          <td style=" padding: 0.35rem 0.5rem;">{{dev.param75}}</td>
                          <td style=" padding: 0.35rem 0.5rem;" *ngIf="keybooleana1">
                            <span class="material-icons text-success text-sm" style="cursor:pointer" placement="bottom"
                              ngbTooltip="Edit Entry" (click)="Updatedata(dev)">
                              create
                            </span>
                            &nbsp;
                            <span class="material-icons text-danger text-sm" style="cursor:pointer" placement="bottom"
                              ngbTooltip="Delete Entry" id="deletebtn" data-toggle="modal" (click)="DeleteModal(dev)"
                              data-target="#modeldelete">
                              delete
                            </span>
                          </td>
                        </tr>
                      </tbody>
                      <tfoot id="foot">
                        <tr>
                          <td colspan="10">
                            <pagination-controls style=" float: right;" (pageChange)="pageChanged($event)">
                            </pagination-controls> <!--   -->
                          </td>
                        </tr>
                      </tfoot>
                    </table>
                    <!--Dummy Table of Excel -->
                    <div style=" display: none;">
                      <div class="row" id="PDFTable" style=" height : 480px; overflow-y: hidden; " #epltable>
                        <table id="dtBasicExample" class="table table-striped table-bordered table-responsive"
                          width="100%"
                          style="font-size: 11px; text-align: center; color:black; border-collapse:collapse; ">
                          <thead>
                            <tr>
                              <th (click)="sort('rowNumber')">#</th>
                              <th (click)="sort('param69')">Section / Department</th>
                              <th (click)="sort('param74')">Received Date</th>
                              <th (click)="sort('param12')">Device No</th>
                              <th (click)="sort('param2')">IMEI NO</th>
                              <th (click)="sort('param5')">Mobile No.</th>
                              <th (click)="sort('param7')">Network</th>
                              <th (click)="sort('param37')">Assign To</th>
                              <th (click)="sort('param61')">Device Status</th>
                              <th (click)="sort('param40')">Polling Time</th>
                              <th (click)="sort('param75')">Remark</th>
                            </tr>
                          </thead>
                          <tbody id="grid">
                            <tr *ngFor="let dev of globalPDF$" style=" padding: 0.35rem 0.5rem;">
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.rowNumber}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param69}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param74 | date:'dd-MMM-yyyy'}}</td>
                              <!-- | date:'dd-MMM-yyyy HH:mm:ss a' -->
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param12}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param2}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param5}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param7}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param37}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param61}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param40 | date:'dd-MMM-yyyy hh:mm:ss aa'}}</td>
                              <td style=" padding: 0.35rem 0.5rem;">{{dev.param75}}</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>

                  </div>

                </div>

              </div>
            </div>

          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<!-- ------------------ Delete Model Start ------------------------>

<!-- Delete Model-->
<div class="modal fade" id="modeldelete">
  <div class="modal-dialog modal-sm modal-dialog-centered">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header" style="background-color: 	red;">
        <h4 class="modal-title text-center" style="color: yellow">Are You Sure?</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body" style="background-color: #f0e8e9">

        <div class="form-group row">


          <div class="col-lg-12 col-md-12">
            <label style="color: black">Remark</label>&nbsp;
            <span class="indlabelstar">*</span>
            <textarea class="form-control" rows="2" style=" font-size:12px" placeholder="Enter Remark" tabindex="1"
              minlength="10" maxlength="40" [(ngModel)]="deleteText" #regaddress="ngModel" id="deleteremark"></textarea>

          </div>

        </div>
        <span class="invalidmsg" id="msg_error_delete">{{successMessage}}</span>
        <p style="    background-color: yellow;
        /* padding-right: 20px; */
        margin-right: 89px;
        color: red; display: none;">Do You want to Delete !!&hellip;</p>
      </div>


      <!-- Modal footer -->
      <div class="modal-footer text-center" style="background-color: #cfbaa8">
        <button type="submit" class="btndel btn-primary mr-3" data-toggle="modal" data-dismiss="modal" tabindex="18">
          No
        </button>
        <button type="reset" tabindex="19" class="btndel btn-danger " data-toggle="modal" data-dismiss="modal"
          (click)="Deletefunction()">
          Yes
        </button>
      </div>

    </div>
  </div>
</div>
<!-- Delete Model -->

<!-- ------------------- Delete model End ----------------------- -->
<div class="modal fade " id="SuccessModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
  aria-hidden="true">
  <div class="modal-dialog modal-sm dialogModal" role="document">
    <div class="modal-content box-shadow">
      <div class="card text-center border-0">
        <div class="card-header bg-success m-0 p-0">
          <h5>Success</h5>
        </div>
        <div class="card-body bg-white">
          {{datafromrespo}}
          <div class="text-right">
            <button class="btn btn-sm btn-success" data-dismiss="modal" (click)="closemodal()">ok</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade " id="ErrorModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog"
  aria-hidden="true">
  <div class="modal-dialog modal-sm dialogModal" role="document">
    <div class="modal-content box-shadow">
      <div class="card text-center border-0">
        <div class="card-header bg-warning m-0 p-0">
          <h5>Failed</h5>
        </div>
        <div class="card-body bg-white">
          {{datafromrespo}}
          <div class="text-right pt-3">
            <button class="btn btn-sm btn-success" data-dismiss="modal" (click)="closemodal()">ok</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>